# 开发环境搭建

## 系统环境

- Archlinux
- Rust v1.75.0
- node v21.6.0
- pnpm v8.14.1

## 后端热加载

### 安装依赖

```shell
cargo install systemfd cargo-watch
```

### 热重启(推荐)

```shell
cargo watch -d 2 -x clippy -x run
```

### 以套接字的方式热重启

```shell
systemfd --no-pid -s http::3000 -- cargo watch -x run
```

## Actix Web OpenTelemetry

- [actix-web-opentelemetry](https://github.com/OutThereLabs/actix-web-opentelemetry)

```shell
# Run jaeger in background
$ docker run -d -p6831:6831/udp -p6832:6832/udp -p16686:16686 jaegertracing/all-in-one:latest

# Run server example with tracing middleware
$ cargo run
# (In other tab) Run client example with request tracing
$ cargo run --features awc

# View spans (see the image below)
$ open http://localhost:16686/
```

## 加速编译 mold 方案

并行化加载来提高链接器性.

### 安装 mold

- arch

```shell
sudo pacman -S mold
```

- ubuntu

```shell
sudo apt install mold
```

### 添加配置

> vim .cargo/config.toml

```shell
[target.x86_64-unknown-linux-gnu]
linker = "clang"
rustflags = ["-C", "link-arg=-fuse-ld=/usr/bin/mold"]
```
